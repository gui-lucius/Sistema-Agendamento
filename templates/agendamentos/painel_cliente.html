{% extends 'base/base.html' %}
{% load static %}

{% block title %}Minha Conta - Barbearia RD{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/pages/perfil.css' %}">
{% endblock %}

{% block content %}
<div class="painel-container">
  <h2>ğŸ‘¤ Minha Conta</h2>

  <div class="user-info">
    {% if cliente.foto %}
      <img src="{{ cliente.foto.url }}" alt="Foto do cliente" class="foto-perfil-cliente" />
    {% else %}
      <img src="{% static 'imagens/default-user.png' %}" alt="Sem foto" class="foto-perfil-cliente" />
    {% endif %}

    <p><strong>Nome:</strong> {{ user.first_name }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><strong>UsuÃ¡rio:</strong> {{ user.username }}</p>

    <a href="{% url 'agendamentos:editar_perfil_cliente' %}" class="btn-edit">âœï¸ Editar Perfil</a>
  </div>

  <hr />

  <div class="meus-agendamentos">
    <h2>ğŸ“… Meus Agendamentos da Semana</h2>
    {% if agendamentos %}
      <ul class="agenda-lista">
        {% for ag in agendamentos %}
          <li class="agendamento-item">
            <div class="info-agendamento">
              <strong>{{ ag.servico }}</strong> com <strong>{{ ag.barbeiro.nome }}</strong><br />
              {{ ag.data_horario_reserva|date:"d/m/Y H:i" }} â€” <em>{{ ag.status|title }}</em>
            </div>

            <a
              href="{% url 'agendamentos:cancelar_agendamento' ag.id ag.cancel_token %}"
              class="btn-cancelar"
              title="Cancelar agendamento"
            >ğŸ—‘ï¸</a>

          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="futuro">VocÃª ainda nÃ£o tem nenhum agendamento para essa semana.</p>
    {% endif %}
  </div>

  {% if agendamentos_passados %}
    <hr />
    <div class="agendamentos-passados">
      <h2>ğŸ“– Agendamentos Anteriores</h2>
      <ul class="agenda-lista">
        {% for ag in agendamentos_passados %}
          <li>
            <strong>{{ ag.servico }}</strong> com <strong>{{ ag.barbeiro.nome }}</strong><br />
            {{ ag.data_horario_reserva|date:"d/m/Y H:i" }} â€” <em>{{ ag.status|title }}</em>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <hr />

  <div class="acoes">
    <h2>âš™ï¸ AÃ§Ãµes DisponÃ­veis</h2>
    <ul>
      <li><a href="{% url 'password_change' %}">Alterar senha</a></li>
    </ul>
  </div>

  <hr />

  <form method="POST" action="{% url 'agendamentos:logout' %}">
    {% csrf_token %}
    <button type="submit" class="btn-sair">ğŸšª Sair da Conta</button>
  </form>
</div>
{% endblock %}
